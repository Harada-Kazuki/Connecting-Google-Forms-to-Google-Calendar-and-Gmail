予約管理システム
Google FormsとGoogle Calendarを連携した、予約管理システムです。フォーム送信時に自動でカレンダーに予定を登録し、同時間帯の予約数を制限します。
機能概要

Google Formsからの予約情報を自動でGoogle Calendarに登録
同じ時間帯に最大2名まで予約可能（3名目以降は自動で却下）
予約完了時に管理者へメール通知
予約失敗時に申込者と管理者の両方へメール通知
エラー発生時の管理者への自動通知

前提条件

Google Workspace アカウント
Google Forms の作成権限
Google Calendar の編集権限
Apps Script の実行権限

セットアップ手順
1. Google Formsの作成
以下の質問項目を含むフォームを作成してください：

お名前（記述式）
練習日（日付）
開始時刻（時刻）
終了時刻（時刻）

フォーム設定で「メールアドレスを収集する」を有効にしてください。
2. Google Calendarの準備

予約管理用のカレンダーを作成（または既存のカレンダーを使用）
カレンダーIDを取得

カレンダーの設定を開く
「カレンダーの統合」セクションでカレンダーIDをコピー



3. Apps Scriptの設定

Google Formsを開き、右上の三点メニューから「スクリプトエディタ」を選択
表示されたエディタに上記コードを貼り付け
コード内の設定項目を編集：

javascriptconst calendarId = 'あなたのカレンダーID';
const adminEmails = '管理者1@example.com, 管理者2@example.com';

プロジェクト名を設定
保存アイコンをクリック

4. トリガーの設定

Apps Scriptエディタで左側のメニューから「トリガー」アイコンをクリック
右下の「トリガーを追加」をクリック
以下のように設定：

実行する関数: onFormSubmit
イベントのソース: フォームから
イベントの種類: フォーム送信時


「保存」をクリック
初回は権限の承認が必要です

5. 権限の承認

初回実行時にGoogleアカウントの選択画面が表示されます
「詳細」をクリック
「安全ではないページに移動」をクリック
カレンダーとメールへのアクセス権限を許可

動作フロー

ユーザーがGoogle Formsから予約を送信
スクリプトが自動実行され、以下の処理を実行：

指定時間帯の既存予約数を確認
2名以下の場合：カレンダーに予定を登録し、管理者にメール通知
3名以上の場合：予約を却下し、申込者と管理者の両方にメール通知


エラー発生時は管理者にエラー内容を通知

設定項目の説明
calendarId
予約を登録するGoogle CalendarのID。カレンダーの設定画面から取得できます。
adminEmails
予約通知を受け取る管理者のメールアドレス。カンマ区切りで複数指定可能です。
トラブルシューティング
予約が登録されない

トリガーが正しく設定されているか確認
カレンダーIDが正確か確認
Apps Scriptの実行権限が付与されているか確認

メールが届かない

管理者のメールアドレスが正しいか確認
スパムフォルダを確認
Gmailの送信制限（1日あたり100通）に達していないか確認

エラーメッセージの確認方法

Apps Scriptエディタを開く
左側のメニューから「実行数」をクリック
失敗した実行のログを確認

カスタマイズ例
予約可能人数の変更
javascriptif (events.length >= 2) {  // この数字を変更
イベント名の変更
javascriptcalendar.createEvent('重機練習：' + name, start, end);
メール本文のカスタマイズ
errorBody、subject、bodyの各変数を編集してください。
注意事項

Google Apps Scriptの実行時間制限は6分です
Gmailの送信制限は1日あたり100通です
カレンダーIDや管理者メールアドレスは外部に公開しないでください
本番運用前に必ずテスト送信を行ってください

ライセンス
このスクリプトは自由に改変・利用可能です。
